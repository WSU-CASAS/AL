from unittest import TestCase

from al import AL
from config import Config
from features import twod_features


class TwoDFeaturesTest(TestCase):
    # Test the twod_features() method

    # Note: 2021-01-05: These outputs were generated by running the test data through the actual function

    def test_twodfeatures_regulardata_1(self):
        # arrange
        test_config = Config(description='test_config')
        test_al = AL(conf=test_config)

        test_al.yaw = [-4.1209365687433905, 4.73936390743936, 2.0549839753739008, -4.198495950550571, 4.965063609387329, 2.1775495710694983, -2.573770292135509, -0.8821022753735477, -2.9158172563880793, 0.8535985365947258]
        test_al.pitch = [-3.0230925568128573, -2.6671312148465742, -3.8657004958358687, 4.723650362433135, 3.4410015889827754, 3.6425067288105915, -1.4575834743855975, -4.994321551028488, -2.901135316609399, -1.102457034682649]
        test_al.roll = [0.7243311557456797, 1.8568222829129475, 4.725600855588368, -4.384357348327908, -2.1839539244964703, -3.20557081784254, 4.348827279863048, -0.4707314605834254, -0.9977183154159617, -3.117584021470299]

        test_al.accx = [0.05844021221785867, 0.3093723552931795, 0.43369023641886395, 0.35197657388853476, 0.9145168157063801, -0.16770966910853047, 0.5282857153041645, -0.8220798796952837, 0.11198361544741808, -0.566715759941252]
        test_al.accy = [-0.3173382211044333, 0.9009863434163345, 0.9605133201753344, -0.3861228970702726, 0.1263594716396681, -0.33391623693463246, -0.35194269181853266, 0.5035815046973748, -0.5043574243531437, 0.09026624359190838]
        test_al.accz = [-0.3091853619539313, 0.7448987270344158, -0.2039681870524368, -0.7601912937339452, -0.6608526119802098, -0.21640456690479115, -0.25154277423695204, 0.9140671035884811, -0.1950852633610367, 0.7663759272504558]

        test_al.rotx = [8.892602474208509, 7.540750565777859, 3.783604575202858, 7.191582052001404, -7.2887632191456575, 8.563207910134423, -4.011433138120378, 7.139704631387605, -8.955049716391922, 2.907925527153994]
        test_al.roty = [-1.3933889686158185, -1.7113756916151335, 8.78330292789395, 6.668889250346453, -5.992074582558766, 8.276241258352474, -0.0885236894070971, -6.5341683482088335, 6.617729248988567, -3.2400275186051726]
        test_al.rotz = [8.721531886054727, 6.1672538555739855, 5.9732856956232006, -9.453025939177447, -0.7501632195662218, 5.843310381679119, 4.710128016393282, 0.6160534155117787, -6.593328561631853, 2.9253848829144307]

        expected_output = [0.1187066062874845, 0.8303700220648647, 0.05715532864143094, 0.28037715707002775, -0.6605402910607339, -0.5499928649948369, -0.029005222907204076, 0.04637308032917278, -0.7202474356470668, 0.13236485168812837, 0.5322351016317788, 0.08599177135895558, 0.07202604471685581, 1.4377527775638073, 0.38689029307346406, 0.7603701248833692, -0.18610716230928287, -0.6773826526804381]

        # act
        output = twod_features(test_al)

        # assert
        self.assertEqual(output, expected_output)

    def test_twodfeatures_regulardata_2(self):
        # arrange
        test_config = Config(description='test_config')
        test_al = AL(conf=test_config)

        test_al.yaw = [3.6317176229301324, 0.33934007047028114, 3.0372367359151955, 2.435468875902523, 2.677535436917812, -4.875939389320436, 3.7255954157061755, 3.0348592880766123, 1.9884918660653756, 1.028979894520904]
        test_al.pitch = [-0.7716321906837429, 0.8625940496235716, -2.7316216620050584, -4.930746430206518, 0.4764095915819846, -2.720614050990322, 4.151028784694864, 4.40366622081547, -0.189768870627967, 2.9702168934641033]
        test_al.roll = [4.308347292015865, -1.4432785016386909, 0.702202329299503, -1.032657640017931, 2.0562524142748373, 2.4593866510352917, 2.402426428664823, -1.0428736283248563, 3.825724710375207, 3.916120656445454]

        test_al.accx = [-0.1199386535001119, 0.859772596770763, 0.4394228214883271, -0.6729812222522256, -0.8317235077148759, 0.614803102421414, -0.8766297871630926, 0.7672006084197032, 0.7900726171670636, 0.9064275308293543]
        test_al.accy = [-0.8345073818420425, 0.8972993474788094, 0.05980958485074317, -0.2346683018948561, -0.29555664204099297, -0.46380221044613346, 0.8710479213825999, 0.24818957375627426, -0.33031850742892144, 0.4776496178007328]
        test_al.accz = [0.22417916179981923, 0.5717620440799709, -0.12324012519577243, 0.834640979110886, -0.69406690720878, 0.6332149137994441, -0.3122468748637284, 0.9480359597107826, -0.3356751234315818, -0.6512339331275097]

        test_al.rotx = [0.7577363072299086, -8.447355069706068, -6.837974674605731, 8.584150094336518, 0.7418188571131239, -4.419859509858453, 3.908617548776462, 1.1626911478202118, 7.194299215811881, 8.109464994161684]
        test_al.roty = [8.065414370215418, 5.076852139413999, 2.8558658822836325, -4.309971098412236, 4.329132345685309, -3.038426533719454, 2.4283986335811587, 2.819721503862265, -5.837302446279997, -2.336731246533665]
        test_al.rotz = [2.9947937122171364, 1.3344197923188528, -7.668152003960465, 4.357693823945709, -9.339511990434922, -3.1721747016624473, -1.4657997275377461, 3.9425139537656477, 3.1304183276598465, -8.348705293914886]

        expected_output = [0.2910461370046462, 1.5503753481518188, -0.03547510224500316, 0.0871635105055073, 0.11029281899293204, -1.4632118376463115, 0.14073333467281385, 0.14812831048501063, 0.1851169297093155, 0.0781056011792789, -0.07713218089608631, -0.07002270930573173, -0.5393116529774568, 0.07006353609831084, 0.191804732008585, 2.498809301868281, -0.07831206051220597, 2.4287457657699703]

        # act
        output = twod_features(test_al)

        # assert
        self.assertEqual(output, expected_output)

    def test_twodfeatures_allzeros(self):
        # arrange
        test_config = Config(description='test_config')
        test_al = AL(conf=test_config)

        test_al.yaw = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
        test_al.pitch = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
        test_al.roll = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]

        test_al.accx = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
        test_al.accy = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
        test_al.accz = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]

        test_al.rotx = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
        test_al.roty = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
        test_al.rotz = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]

        expected_output = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]

        # act
        output = twod_features(test_al)

        # assert
        self.assertEqual(output, expected_output)
